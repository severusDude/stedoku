<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Sudoku Game</title>
		<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
		<style>
			.cell-input {
				width: 100%;
				height: 100%;
				text-align: center;
				font-size: 1.25rem;
				border: none;
				outline: none;
				background: transparent;
			}
			.cell-input:focus {
				background-color: #e5edff;
			}
			.prefilled {
				font-weight: bold;
				color: #1a365d;
			}
			.invalid {
				background-color: #fed7d7;
			}
		</style>
	</head>
	<body
		class="bg-gray-100 min-h-screen flex flex-col items-center justify-center p-4"
	>
		<div class="bg-white rounded-xl shadow-lg p-6 max-w-md w-full">
			<h1 class="text-3xl font-bold text-center text-blue-800 mb-4">Sudoku</h1>

			<div class="mb-4 flex justify-between">
				<div>
					<span class="font-medium">Difficulty:</span>
					<select id="difficulty" class="ml-2 px-2 py-1 border rounded">
						<option value="easy">Easy</option>
						<option value="medium">Medium</option>
						<option value="hard">Hard</option>
					</select>
				</div>
				<button
					id="new-game"
					class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-1 rounded"
				>
					New Game
				</button>
			</div>

			<div
				id="board"
				class="grid grid-cols-9 gap-0 border-2 border-gray-800 mb-6"
			>
				<!-- Board will be generated by JavaScript -->
			</div>

			<div class="flex justify-between">
				<button
					id="check"
					class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded"
				>
					Check Solution
				</button>
				<button
					id="solve"
					class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded"
				>
					Solve Puzzle
				</button>
				<button
					id="clear"
					class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded"
				>
					Clear Board
				</button>
			</div>

			<div id="message" class="mt-4 text-center font-medium hidden"></div>
		</div>

		<script src="sudoku.js"></script>
		<script>
			document.addEventListener("DOMContentLoaded", () => {
				// Initialize the game
				const game = new SudokuGame();

				// Generate the board UI
				const boardElement = document.getElementById("board");

				for (let row = 0; row < 9; row++) {
					for (let col = 0; col < 9; col++) {
						const cell = document.createElement("div");
						cell.className =
							"cell w-10 h-10 flex items-center justify-center border border-gray-400";

						// Add thicker borders to separate 3x3 blocks
						if (col % 3 === 2 && col < 8) {
							cell.classList.add("border-r-2", "border-r-gray-800");
						}
						if (row % 3 === 2 && row < 8) {
							cell.classList.add("border-b-2", "border-b-gray-800");
						}

						const input = document.createElement("input");
						input.type = "text";
						input.maxLength = 1;
						input.dataset.row = row;
						input.dataset.col = col;
						input.className = "cell-input";

						// Allow only numbers 1-9
						input.addEventListener("input", (e) => {
							e.target.value = e.target.value.replace(/[^1-9]/g, "");
							game.updateCell(
								row,
								col,
								e.target.value ? parseInt(e.target.value) : 0
							);
						});

						// Move to next cell on keydown
						input.addEventListener("keydown", (e) => {
							if (e.key === "ArrowRight" && col < 8) {
								document
									.querySelector(`[data-row="${row}"][data-col="${col + 1}"]`)
									.focus();
							} else if (e.key === "ArrowLeft" && col > 0) {
								document
									.querySelector(`[data-row="${row}"][data-col="${col - 1}"]`)
									.focus();
							} else if (e.key === "ArrowUp" && row > 0) {
								document
									.querySelector(`[data-row="${row - 1}"][data-col="${col}"]`)
									.focus();
							} else if (e.key === "ArrowDown" && row < 8) {
								document
									.querySelector(`[data-row="${row + 1}"][data-col="${col}"]`)
									.focus();
							}
						});

						cell.appendChild(input);
						boardElement.appendChild(cell);
					}
				}

				// Event listeners for buttons
				document.getElementById("new-game").addEventListener("click", () => {
					const difficulty = document.getElementById("difficulty").value;
					game.newGame(difficulty);
					updateBoardUI(game);
					document.getElementById("message").classList.add("hidden");
				});

				document.getElementById("check").addEventListener("click", () => {
					const isValid = game.checkSolution();
					const messageEl = document.getElementById("message");

					if (isValid) {
						messageEl.textContent =
							"Congratulations! Your solution is correct!";
						messageEl.className = "mt-4 text-center font-medium text-green-600";
					} else {
						messageEl.textContent =
							"Sorry, there are some errors in your solution.";
						messageEl.className = "mt-4 text-center font-medium text-red-600";
					}
					messageEl.classList.remove("hidden");
				});

				document.getElementById("solve").addEventListener("click", () => {
					game.solve();
					updateBoardUI(game);
					document.getElementById("message").classList.add("hidden");
				});

				document.getElementById("clear").addEventListener("click", () => {
					game.clearBoard();
					updateBoardUI(game);
					document.getElementById("message").classList.add("hidden");
				});

				// Function to update the UI based on the game state
				function updateBoardUI(game) {
					const cells = document.querySelectorAll(".cell-input");
					cells.forEach((cell) => {
						const row = parseInt(cell.dataset.row);
						const col = parseInt(cell.dataset.col);
						const value = game.board[row][col];

						cell.value = value !== 0 ? value : "";
						cell.classList.toggle("prefilled", game.prefilled[row][col]);
						cell.disabled = game.prefilled[row][col];
					});
				}

				// Start a new game
				game.newGame("easy");
				updateBoardUI(game);
			});
		</script>
	</body>
</html>
